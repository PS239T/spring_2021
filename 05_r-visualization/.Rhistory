rm(list=ls())
knitr::opts_chunk$set(echo = FALSE)
# install packages
library(ggplot2)
library(gtrendsR)
library(png)
anscombe
anscombe %>%
gather(x_name, x_value, x1:x4) %>%
gather(y_name, y_value, y1:y4)
rm(list=ls())
knitr::opts_chunk$set(echo = FALSE)
# install packages
pacman::p_load(
ggplot2,
dplyr,
tidyr
)
# anscombe's data
anscombe %>%
gather(x_name, x_value, x1:x4) %>%
gather(y_name, y_value, y1:y4)
anscombe %>%
gather(x_name, x_value, x1:x4) %>%
gather(y_name, y_value, y1:y4) %>%
ggplot(aes(x_value, y_value) +
geom_point() +
facet_grid(~x_name)
anscombe %>%
anscombe
anscombe %<%
gather(x_name, x_value, x1:x4) %<%
gather(y_name, y_value, y1:y4) %<%
ggplot(aes(x_value, y_value)) +
geom_point() +
facet_grid(~x_name)
anscombe %>%
gather(x_name, x_value, x1:x4) %>%
gather(y_name, y_value, y1:y4) %>%
ggplot(aes(x_value, y_value)) +
geom_point() +
facet_grid(~x_name)
anscombe %>%
gather(x_name, x_value, x1:x4) %>%
gather(y_name, y_value, y1:y4) #%>%
ggplot(aes(x_value, y_value)) +
geom_point() +
facet_grid(~x_name)
anscombe %>%
gather(x_name, x_value, x1:x4) %>%
gather(y_name, y_value, y1:y4) #%>%
# ggplot(aes(x_value, y_value)) +
#          geom_point() +
#          facet_grid(~x_name)
anscombe %>%
gather(x_name, x_value, x1:x4) %>%
gather(y_name, y_value, y1:y4) %>%
ggplot(aes(x_value, y_value, col = x_name)) +
geom_point()
anscombe %>%
gather(x_name, x_value, x1:x4) %>%
gather(y_name, y_value, y1:y4) %>%
ggplot(aes(x_value, y_value)) +
facet_wrap(~x_name)
anscombe %>%
gather(x_name, x_value, x1:x4) %>%
gather(y_name, y_value, y1:y4) %>%
ggplot(aes(x_value, y_value)) +
facet_grid(~x_name)
anscombe %>%
gather(x_name, x_value, x1:x4) %>%
gather(y_name, y_value, y1:y4) %>%
ggplot(aes(x_value, y_value)) +
geom_point() +
facet_grid(~x_name)
anscombe %>%
gather(x_name, x_value, x1:x4) %>%
gather(y_name, y_value, y1:y4)
anscombe
anscombe %>%
gather(x_name, x_value, x1:x4) %>%
gather(y_name, y_value, y1:y4) %>%
ggplot(aes(x_value, y_value)) +
geom_point() +
facet_grid(~y_name)
anscombe
cor(anscombe)
rm(list=ls())
knitr::opts_chunk$set(echo = FALSE)
# install packages
pacman::p_load(
ggplot2,
dplyr,
tidyr,
psyche
)
# install packages
pacman::p_load(
ggplot2,
dplyr,
tidyr,
psych
)
rm(list=ls())
knitr::opts_chunk$set(echo = FALSE)
# install packages
pacman::p_load(
ggplot2,
dplyr,
tidyr
)
cor(anscombe)[c(1:4),c(5:8)]
# clean global environment
rm(list = ls())
pacman::p_load(
knitr,
zoo,
foreign,
ggplot2,
reshape,
reshape2,
plyr,
reshape2,
tidyr,
dplyr,
tm,
tau,
koRpus,
tidyverse,
tidytext,
quanteda,
SnowballC,
stringr,
readtext,
stringi,
topicmodels,
spacyr,
corpustools,
stm,
igraph,
stmCorrViz,
splitstackshape,
keras,
purrr,
caret,
kernlab,
e1071)
# load data
## random sample
asian_sample <- readRDS("asian_sample.rds")
black_sample <- readRDS("afro_sample.rds")
## coded articles
asian_coded <- read.csv("/home/jae/linked_fate_evolution/Data/training_asian.csv")
black_coded <- read.csv("/home/jae/linked_fate_evolution/Data/training_black.csv")
## full newspapers
asian_newspaper <- readRDS("/home/jae/linked_fate_evolution/Data/asian_newspaper.rds")
black_newspaper <- readRDS("/home/jae/linked_fate_evolution/Data/black_newspaper.rds")
# load function
source("/home/jae/linked_fate_evolution/Functions/functions.r")
source("/home/jae/functions-/theme_publication.r")
# asian
asian_coded %>%
group_by(linked_progress, linked_hurt) %>%
summarize(n=n())
# clean global environment
rm(list = ls())
pacman::p_load(
knitr,
zoo,
foreign,
ggplot2,
reshape,
reshape2,
plyr,
reshape2,
tidyr,
dplyr,
tm,
tau,
koRpus,
tidyverse,
tidytext,
quanteda,
SnowballC,
stringr,
readtext,
stringi,
topicmodels,
spacyr,
corpustools,
stm,
igraph,
stmCorrViz,
splitstackshape,
keras,
purrr,
caret,
kernlab,
e1071)
# load data
## random sample
asian_sample <- readRDS("asian_sample.rds")
black_sample <- readRDS("afro_sample.rds")
## coded articles
asian_coded <- read.csv("/home/jae/linked_fate_evolution/Data/training_asian.csv")
black_coded <- read.csv("/home/jae/linked_fate_evolution/Data/training_black.csv")
## full newspapers
asian_newspaper <- readRDS("/home/jae/linked_fate_evolution/Data/asian_newspaper.rds")
black_newspaper <- readRDS("/home/jae/linked_fate_evolution/Data/black_newspaper.rds")
# load function
source("/home/jae/linked_fate_evolution/Functions/functions.r")
source("/home/jae/functions-/theme_publication.r")
# asian
asian_coded %>%
group_by(linked_progress, linked_hurt) %>%
summarize(n=n())
# add too columns
## asian
asian_sample$linked_progress <- asian_coded$linked_progress
asian_sample$linked_hurt <- asian_coded$linked_hurt
## black
black_sample$linked_progress <- black_coded$linked_progress
black_sample$linked_hurt <- black_coded$linked_hurt
# reduce duplicates
## asian
asian_sample <- distinct(asian_sample, author, date, source, text, year,
linked_progress, linked_hurt)
asian_newspaper <- distinct(asian_newspaper, author, date, source, text, year)
## black
black_sample <- distinct(black_sample, author, date, source, text, year,
linked_progress, linked_hurt)
black_newspaper <- distinct(black_newspaper, author, date, source, text, year)
# join
## asian
asian_full <- full_join(asian_newspaper, asian_sample)
## black
black_full <- full_join(black_newspaper, black_sample)
# substitute
## sample
asian_sample$text <- gsub("\n", "", asian_sample$text)
black_sample$text <- gsub("\n", "", black_sample$text)
asian_sample$text <- gsub("\"", "", asian_sample$text)
black_sample$text <- gsub("\"", "", black_sample$text)
## full text
asian_full$text <- gsub("\n", "", asian_full$text)
black_full$text <- gsub("\n", "", black_full$text)
asian_full$text <- gsub("\"", "", asian_full$text)
black_full$text <- gsub("\"", "", black_full$text)
asian_sample$text <- asian_sample$text %>%
tolower() # lower case
# removePunctuation() #%>% # remove punctuation
# removeNumbers() %>% # remove numbers
# stripWhitespace() #%>% # remove whitespace
# removeWords(stopwords('en')) ## stop words
black_sample$text <- black_sample$text %>%
tolower() # lower case
# removePunctuation() #%>% # remove punctuation
# removeNumbers() %>% # remove numbers
# stripWhitespace() #%>% # remove whitespace
# removeWords(stopwords('en')) ## stop words
asian_full$text <- asian_full$text %>%
tolower() # lower case
# removePunctuation() #%>% # remove punctuation
# removeNumbers() %>% # remove numbers
# stripWhitespace() #%>% # remove whitespace
# removeWords(stopwords('en')) ## stop words
black_full$text <- black_full$text %>%
tolower() # lower case
# removePunctuation() #%>% # remove punctuation
# removeNumbers() %>% # remove numbers
# stripWhitespace() #%>% # remove whitespace
# removeWords(stopwords('en')) ## stop words
# labeled articles
asian_lp_data <- read.csv("/home/jae/linked_fate_evolution/Output/asian_lp_data.csv")
asian_lh_data <- read.csv("/home/jae/linked_fate_evolution/Output/asian_lh_data.csv")
black_lp_data <- read.csv("/home/jae/linked_fate_evolution/Output/black_lp_data.csv")
black_lh_data <- read.csv("/home/jae/linked_fate_evolution/Output/black_lh_data.csv")
asian_full_labeled <- cbind(asian_full,
asian_lp_data$labeled_linked_progress,
asian_lh_data$labeled_linked_hurt)
black_full_labeled <- cbind(black_full,
black_lp_data$labeled_linked_progress,
black_lh_data$labeled_linked_hurt)
# data
asian_full_labeled %>%
group_by(`asian_lp_data$labeled_linked_progress`, `asian_lh_data$labeled_linked_hurt`) %>%
summarize(n = n())
asian_full_labeled$lp_exclusvie <- ifelse(asian_full_labeled$`asian_lp_data$labeled_linked_progress` == 1 & asian_full_labeled$`asian_lh_data$labeled_linked_hurt` == 0, 1, 0)
asian_full_labeled$lh_exclusvie <- ifelse(asian_full_labeled$`asian_lp_data$labeled_linked_progress` == 0 & asian_full_labeled$`asian_lh_data$labeled_linked_hurt` == 1, 1, 0)
asian_full_labeled$lf_mixed <-
ifelse(asian_full_labeled$`asian_lp_data$labeled_linked_progress` == 1 & asian_full_labeled$`asian_lh_data$labeled_linked_hurt` == 1, 1, 0)
## black
black_full_labeled$lp_exclusvie <- ifelse(black_full_labeled$`black_lp_data$labeled_linked_progress` == 1 & black_full_labeled$`black_lh_data$labeled_linked_hurt` == 0, 1, 0)
black_full_labeled$lh_exclusvie <- ifelse(black_full_labeled$`black_lp_data$labeled_linked_progress` == 0 & black_full_labeled$`black_lh_data$labeled_linked_hurt` == 1, 1, 0)
black_full_labeled$lf_mixed <-
ifelse(black_full_labeled$`black_lp_data$labeled_linked_progress` == 1 & black_full_labeled$`black_lh_data$labeled_linked_hurt` == 1, 1, 0)
## frequency
sum(asian_full_labeled$lh_exclusvie)/sum(asian_full_labeled$lp_exclusvie)
sum(black_full_labeled$lh_exclusvie)/sum(black_full_labeled$lp_exclusvie)
# merge
full_labeled <- rbind(
mutate(asian_full_labeled[,-c(8,9)], group = "Asian Americans"),
mutate(black_full_labeled[,-c(8,9)], group = "African Americans"))
# factor level
full_labeled$group <- factor(full_labeled$group, levels = c("Asian Americans", "African Americans"))
full_labeled %>%
group_by(group, year) %>%
summarize(lp_mean = mean(lp_exclusvie),
lh_mean = mean(lh_exclusvie),
mixed_mean = mean(lf_mixed)) %>%
gather(mean_type, value, lp_mean, lh_mean, mixed_mean) %>%
ggplot(aes(x = year, y = value*100, col = mean_type)) +
geom_point(size = 2) +
geom_smooth() +
#  ylim(c(0,17)) +
theme_Publication() +
scale_color_manual(name = "Type", labels = c("Linked hurt","Linked progress","Mixed"), values=c("red","blue","purple")) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_wrap(~group) +
labs(title = "Longitudinal comparison", y = "Percentage", x = "Year")
names(full_labeled)
